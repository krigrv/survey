<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard - Survey Builder</title>
    <link rel="icon" type="image/x-icon" href="/favicon.ico">
    
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    
    <!-- Font Awesome -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    
    <!-- Sortable.js for form builder -->
    <script src="https://cdn.jsdelivr.net/npm/sortablejs@1.15.0/Sortable.min.js"></script>
    
    <!-- Custom CSS -->
    <link href="/css/dhl-theme.css" rel="stylesheet">
    <link href="/css/forms.css" rel="stylesheet">
    <link href="/css/shadcn-forms.css" rel="stylesheet">
    <link href="/css/form-builder.css" rel="stylesheet">
    <link href="/css/steps.css" rel="stylesheet">
    <!-- Authentication CSS removed -->
</head>
<body>    <header class="dhl-header">
        <nav class="dhl-nav">
            <a href="/" class="dhl-logo">
                <img src="/images/dhl-logo.svg" alt="DHL Survey Builder" style="height: 32px; margin-right: 8px;">
            </a>
            <ul class="dhl-nav-links">
                <li><a href="/" class="dhl-nav-link">Home</a></li>
                <li><a href="/dashboard.html" class="dhl-nav-link active">Dashboard</a></li>
                <li><a href="/forms-list.html" class="dhl-nav-link">Forms</a></li>
                <li><a href="/apps.html" class="dhl-nav-link">Apps</a></li>
            </ul>
        </nav>
    </header>

    <!-- Main Content -->
    <div class="dhl-container py-4">
        <!-- Alert Container -->
        <div id="alertContainer" class="position-fixed top-0 end-0 p-3" style="z-index: 1050;"></div>
        <!-- Breadcrumbs -->
        <div id="breadcrumbs" class="mb-4"></div>
        
        <!-- Page Header -->
        <div class="page-header mb-4">
            <div class="row align-items-center">
                <div class="col">
                    <h1 class="page-title">
                        <i class="fas fa-tachometer-alt"></i>
                        Dashboard
                    </h1>
                    <p class="page-description text-muted">Welcome back! Manage your tenants, forms, and analytics.</p>
                </div>
            </div>
        </div>

        <!-- Step-by-Step Progress Layout -->
        <div class="row">
            <!-- Left Sidebar - Steps Navigation -->
            <div class="col-md-3">
                <div class="steps-sidebar">
                    <div class="steps-container">
                        <div class="step-item active" data-step="1" data-target="#tenant-onboarding">
                            <div class="step-number">1</div>
                            <div class="step-content">
                                <div class="step-title">Tenant Onboarding</div>
                                <div class="step-description">Setup your organization</div>
                            </div>
                            <div class="step-connector"></div>
                        </div>
                        
                        <div class="step-item" data-step="2" data-target="#form-creation">
                            <div class="step-number">2</div>
                            <div class="step-content">
                                <div class="step-title">Form Creation</div>
                                <div class="step-description">Build survey forms</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Right Content Area -->
            <div class="col-md-9">
                <!-- Step Content -->
                <div class="step-content-area">
                    <!-- Step 1: Tenant Onboarding -->
                    <div class="step-pane active" id="tenant-onboarding">
                        <div class="step-header mb-4">
                            <h3 class="step-main-title">
                                <span class="step-badge">Step 1</span>
                                <i class="fas fa-building"></i> Tenant Onboarding
                            </h3>
                            <p class="step-subtitle text-muted">Setup your organization and create your first tenant</p>
                        </div>
                        
                        <div class="row">
                            <!-- Create Tenant Form -->
                            <div class="col-md-6">
                                <div class="card">
                                    <div class="card-header">
                                        <h5 class="card-title mb-0">
                                            <i class="fas fa-plus-circle"></i> Create New Tenant
                                        </h5>
                                    </div>
                                    <div class="card-body">
                                        <form id="tenantForm">
                                            <div class="mb-3">
                                                <label for="teamName" class="form-label">Team Name *</label>
                                                <input type="text" class="form-control" id="teamName" name="teamName" required 
                                                       placeholder="Enter your team name">
                                            </div>
                                            
                                            <div class="mb-3">
                                                <label for="teamDescription" class="form-label">Team Description</label>
                                                <textarea class="form-control" id="teamDescription" name="teamDescription" rows="3" 
                                                          placeholder="Describe your team's purpose"></textarea>
                                            </div>
                                            
                                            <div class="mb-3">
                                                <label for="domain" class="form-label">Domain *</label>
                                                <select class="form-select" id="domain" name="domain" required>
                                                    <option value="">Select domain</option>
                                                    <option value="logistics">Logistics</option>
                                                    <option value="shipping">Shipping</option>
                                                    <option value="warehouse">Warehouse</option>
                                                    <option value="delivery">Delivery</option>
                                                    <option value="customs">Customs</option>
                                                    <option value="finance">Finance</option>
                                                    <option value="hr">Human Resources</option>
                                                    <option value="it">IT Support</option>
                                                </select>
                                            </div>
                                            
                                            <div class="mb-3">
                                                <label for="adminAccess" class="form-label">Admin Email *</label>
                                                <input type="email" class="form-control" id="adminAccess" name="adminAccess" required 
                                                       placeholder="admin@domain.com">
                                            </div>
                                            
                                            <button type="submit" class="btn btn-primary">
                                                <i class="fas fa-save"></i> Create Tenant
                                            </button>
                                        </form>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Existing Tenants List -->
                            <div class="col-md-6">
                                <div class="card">
                                    <div class="card-header">
                                        <h5 class="card-title mb-0">
                                            <i class="fas fa-list"></i> Existing Form Types
                                        </h5>
                                    </div>
                                    <div class="card-body">
                                        <div id="tenantsList">
                                            <div class="text-center py-3">
                                                <div class="spinner-border spinner-border-sm text-primary" role="status">
                                                    <span class="visually-hidden">Loading...</span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Step 2: Form Creation -->
                    <div class="step-pane" id="form-creation">
                        <div class="step-header mb-4">
                            <h3 class="step-main-title">
                                <span class="step-badge">Step 2</span>
                                <i class="fas fa-plus-circle"></i> Form Creation
                            </h3>
                            <p class="step-subtitle text-muted">Create and design your survey forms</p>
                        </div>
                <div class="row">
                    <div class="col-12">
                        <div class="card">
                            <div class="card-header">
                                <h5 class="card-title mb-0">
                                    <i class="fas fa-plus-circle"></i> Create Survey Form
                                </h5>
                            </div>
                            <div class="card-body">
                                <form id="surveyFormCreation">
                                    <div class="row">
                                        <div class="col-md-6">
                                            <div class="mb-3">
                                                <label for="tenantSelect" class="form-label">Select Tenant *</label>
                                                <select class="form-select" id="formType" name="formType" required>
                                                    <option value="">Choose a tenant</option>
                                                    <!-- Options will be loaded dynamically -->
                                                </select>
                                            </div>
                                        </div>
                                        <div class="col-md-6">
                                            <div class="mb-3">
                                                <label for="surveyFormName" class="form-label">Survey Form Name *</label>
                                                <input type="text" class="form-control" id="surveyFormName" name="surveyFormName" required placeholder="Enter survey form name">
                                                <small class="form-text text-muted">Enter a descriptive name for your survey</small>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="mb-3">
                                        <button type="submit" class="dhl-btn dhl-btn-primary">
                                            <i class="fas fa-arrow-right"></i> Proceed to Form Builder
                                        </button>
                                    </div>
                                </form>
                                
                                <!-- Form Builder Container (will be shown when proceeding) -->
                                <div id="formBuilderContainer" style="display: none;">
                                    <!-- Breadcrumb for form builder -->
                                    <nav aria-label="breadcrumb" class="mb-3">
                                        <ol class="breadcrumb">
                                            <li class="breadcrumb-item"><a href="#" id="backToFormCreation">Create Survey Form</a></li>
                                            <li class="breadcrumb-item active" aria-current="page">Form Builder</li>
                                        </ol>
                                    </nav>
                                    
                                    <!-- Form Builder Actions -->
                                    <div class="form-builder-actions mb-3 d-flex gap-2">
                                        <button class="dhl-btn dhl-btn-outline" id="previewForm">
                                            <i class="fas fa-eye"></i> Preview
                                        </button>
                                        <button class="dhl-btn dhl-btn-outline" id="saveForm">
                                            <i class="fas fa-save"></i> Save
                                        </button>
                                        <button class="dhl-btn dhl-btn-primary" id="publishForm">
                                            <i class="fas fa-rocket"></i> Publish
                                        </button>
                                        <button class="dhl-btn dhl-btn-outline" id="formSettings">
                                            <i class="fas fa-cog"></i> Settings
                                        </button>
                                    </div>
                                    
                                    <!-- Integrated Form Builder Content -->
                                    <div class="google-forms-container dhl-card" style="border: 2px solid var(--primary-color); padding: var(--spacing-md); margin-bottom: var(--spacing-md);">
                                        <!-- Top Tabs -->
                                        <div class="form-tabs">
                                            <div class="tab-container">
                                                <button class="tab-button active" data-tab="questions">
                                                    <i class="fas fa-question-circle"></i> Questions
                                                </button>
                                            </div>
                                        </div>

                                        <!-- Main Form Area -->
                                        <div class="form-main-area">
                                            <!-- Questions Tab Content -->
                                            <div class="tab-content" id="questionsTab">
                                                <!-- Form Header Card -->
                                                <div class="form-header-card dhl-card" style="border: 1px solid var(--dhl-gray-light); margin-bottom: var(--spacing-md);">
                                                    <div class="form-header-content" style="padding: var(--spacing-md);">
                                                        <input type="text" class="form-title-input" placeholder="Untitled form" id="builderFormTitle" value="Untitled form" style="border: 1px solid var(--dhl-gray-light); border-radius: var(--border-radius-sm); padding: var(--spacing-sm);">
                                                        <div class="form-type-selector" style="margin: 10px 0;">
                                                            <label for="builderFormType" style="display: block; margin-bottom: 5px; font-weight: 500; color: var(--text-primary);">Form Type *</label>
                                                            <select class="form-type-dropdown" id="builderFormType" style="width: 100%; max-width: 300px; border: 1px solid var(--dhl-gray-light); border-radius: var(--border-radius-sm); padding: var(--spacing-sm);">
                                                                <option value="">Select form type...</option>
                                                            </select>
                                                        </div>
                                                        <textarea class="form-description-input" placeholder="Form description" id="builderFormDescription" style="border: 1px solid var(--dhl-gray-light); border-radius: var(--border-radius-sm); padding: var(--spacing-sm);"></textarea>
                                                    </div>
                                                </div>

                                                <!-- Form Questions Container -->
                                                <div class="form-questions-container" id="formQuestions">
                                                    <!-- Sample Question -->
                                                    <div class="question-card dhl-card" data-question-id="1" style="border: 1px solid var(--dhl-gray-light); margin-bottom: var(--spacing-md);">
                                                        <div class="question-content" style="padding: var(--spacing-md);">
                                                            <div class="question-header">
                                                                <input type="text" class="question-title" placeholder="Untitled Question" value="Untitled Question" style="border: 1px solid var(--dhl-gray-light); border-radius: var(--border-radius-sm); padding: var(--spacing-sm); margin-bottom: var(--spacing-sm);">
                                                                <div class="question-type-selector">
                                                                    <select class="question-type-dropdown" style="border: 1px solid var(--dhl-gray-light); border-radius: var(--border-radius-sm); padding: var(--spacing-sm);">
                                                                        <option value="multiple-choice" selected>Multiple choice</option>
                                                                        <option value="short-answer">Short answer</option>
                                                                        <option value="paragraph">Paragraph</option>
                                                                        <option value="checkboxes">Checkboxes</option>
                                                                        <option value="dropdown">Dropdown</option>
                                                                        <option value="linear-scale">Linear scale</option>
                                                                        <option value="date">Date</option>
                                                                        <option value="time">Time</option>
                                                                    </select>
                                                                </div>
                                                            </div>
                                                            
                                                            <div class="question-options">
                                                                <div class="option-item">
                                                                    <div class="option-radio">
                                                                        <input type="radio" disabled>
                                                                    </div>
                                                                    <input type="text" class="option-input" placeholder="Option 1" value="Option 1">
                                                                    <button class="option-delete" title="Delete option">
                                                                        <i class="fas fa-times"></i>
                                                                    </button>
                                                                </div>
                                                                <div class="option-item add-option">
                                                                    <div class="option-radio">
                                                                        <input type="radio" disabled>
                                                                    </div>
                                                                    <span class="add-option-text">Add option or <span class="add-other-link">add "Other"</span></span>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        
                                                        <div class="question-footer">
                                                            <div class="question-actions">
                                                                <button class="action-btn" title="Duplicate">
                                                                    <i class="fas fa-copy"></i>
                                                                </button>
                                                                <button class="action-btn" title="Delete">
                                                                    <i class="fas fa-trash"></i>
                                                                </button>
                                                                <div class="required-toggle">
                                                                    <label class="toggle-label">
                                                                        Required
                                                                        <input type="checkbox" class="required-checkbox">
                                                                        <span class="toggle-slider"></span>
                                                                    </label>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>

                                                <!-- Add Question Button -->
                                                <div class="add-question-container">
                                                    <button class="add-question-btn dhl-btn dhl-btn-primary" id="addQuestionBtn" style="border: 1px solid var(--primary-color);">
                                                        <i class="fas fa-plus"></i> Add Question
                                                    </button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>


                </div>
            </div>
        </div>

    <!-- Create Form Modal -->
    <div class="modal fade" id="createFormModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">
                        <i class="fas fa-plus"></i> Create New Form
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <form id="createFormForm">
                    <div class="modal-body">
                        <div class="mb-3">
                            <label for="formTitle" class="form-label">Form Title *</label>
                            <input type="text" class="form-control" id="formTitle" name="title" required placeholder="Enter form title">
                            <div class="invalid-feedback"></div>
                        </div>
                        <div class="mb-3">
                            <label for="formDescription" class="form-label">Description</label>
                            <textarea class="form-control" id="formDescription" name="description" rows="3" placeholder="Brief description of the form"></textarea>
                            <div class="invalid-feedback"></div>
                        </div>
                        <div class="mb-3">
                            <label for="formApplication" class="form-label">Application *</label>
                            <select class="form-select" id="formApplication" name="applicationId" required>
                                <option value="">Select Application</option>
                                <!-- Options will be loaded dynamically -->
                            </select>
                            <div class="invalid-feedback"></div>
                        </div>
                        <div class="mb-3">
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="formIsPublic" name="isPublic">
                                <label class="form-check-label" for="formIsPublic">
                                    Public Form (accessible without login)
                                </label>
                            </div>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                        <button type="submit" class="btn btn-primary">
                            <i class="fas fa-save"></i> Create & Edit
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Create User Modal -->
    <div class="modal fade" id="createUserModal" tabindex="-1">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">
                        <i class="fas fa-user-plus"></i> Create User
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <form id="createUserForm">
                    <div class="modal-body">
                        <div class="row g-3">
                            <div class="col-md-6">
                                <label for="createFirstName" class="form-label">First Name *</label>
                                <input type="text" class="form-control" id="createFirstName" name="firstName" required>
                                <div class="invalid-feedback"></div>
                            </div>
                            <div class="col-md-6">
                                <label for="createLastName" class="form-label">Last Name *</label>
                                <input type="text" class="form-control" id="createLastName" name="lastName" required>
                                <div class="invalid-feedback"></div>
                            </div>
                            <div class="col-12">
                                <label for="createEmail" class="form-label">Email *</label>
                                <input type="email" class="form-control" id="createEmail" name="email" required>
                                <div class="invalid-feedback"></div>
                            </div>
                            <div class="col-md-6">
                                <label for="createPassword" class="form-label">Password *</label>
                                <input type="password" class="form-control" id="createPassword" name="password" required>
                                <div class="invalid-feedback"></div>
                            </div>
                            <div class="col-md-6">
                                <label for="createRole" class="form-label">Role *</label>
                                <select class="form-select" id="createRole" name="role" required>
                                    <option value="">Select Role</option>
                                    <option value="user">User</option>
                                    <option value="admin">Admin</option>
                                    <option value="super_admin">Super Admin</option>
                                </select>
                                <div class="invalid-feedback"></div>
                            </div>
                            <div class="col-12">
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" id="createIsActive" name="isActive" checked>
                                    <label class="form-check-label" for="createIsActive">
                                        Active User
                                    </label>
                                </div>
                            </div>
                            <div class="col-12">
                                <label class="form-label">Application Access</label>
                                <div id="createUserAppAccess" class="app-access-container">
                                    <!-- App access options will be loaded here -->
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                        <button type="submit" class="btn btn-primary">
                            <i class="fas fa-save"></i> Create User
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Create Application Modal -->
    <div class="modal fade" id="createAppModal" tabindex="-1">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">
                        <i class="fas fa-plus"></i> Create Application
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <form id="createAppForm">
                    <div class="modal-body">
                        <div class="row g-3">
                            <div class="col-12">
                                <label for="createAppName" class="form-label">Application Name *</label>
                                <input type="text" class="form-control" id="createAppName" name="name" required>
                                <div class="invalid-feedback"></div>
                            </div>
                            <div class="col-12">
                                <label for="createAppDescription" class="form-label">Description</label>
                                <textarea class="form-control" id="createAppDescription" name="description" rows="3" placeholder="Brief description of the application"></textarea>
                                <div class="invalid-feedback"></div>
                            </div>
                            <div class="col-md-6">
                                <label for="createAppIcon" class="form-label">Icon (Font Awesome class)</label>
                                <input type="text" class="form-control" id="createAppIcon" name="icon" placeholder="fas fa-th-large">
                                <small class="form-text text-muted">Example: fas fa-chart-bar, fas fa-users, etc.</small>
                                <div class="invalid-feedback"></div>
                            </div>
                            <div class="col-md-6">
                                <label for="createAppColor" class="form-label">Theme Color</label>
                                <input type="color" class="form-control form-control-color" id="createAppColor" name="color" value="#0d6efd">
                                <div class="invalid-feedback"></div>
                            </div>
                            <div class="col-12">
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" id="createAppIsActive" name="isActive" checked>
                                    <label class="form-check-label" for="createAppIsActive">
                                        Active Application
                                    </label>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                        <button type="submit" class="btn btn-primary">
                            <i class="fas fa-save"></i> Create Application
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Toast Container -->
    <div class="toast-container position-fixed bottom-0 end-0 p-3" id="toastContainer"></div>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <!-- Date-fns -->
    <script type="module">
    import * as datefns from 'https://cdn.jsdelivr.net/npm/date-fns@2.29.3/esm/index.js';
    window.datefns = datefns;
    </script>
    
    <!-- Custom JS -->
    <script src="/js/utils.js"></script>
    <script src="/js/api.js"></script>
    <!-- Authentication script removed -->
    <script src="/js/dashboard.js"></script>
    <script src="/js/form-builder.js"></script>
    <script src="/js/main.js"></script>
</body>
</html>